<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./assets/style/index.css" />
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.slim.js"></script>
  </head>
  <body>
    <div id="listBox">
      <table id="list">
        <tr>
          <th>班級</th>
          <th>座號</th>
          <th>小隊</th>
          <th>棒次</th>
          <th>檢查點1</th>
          <th>檢查點2</th>
          <th>檢查點3</th>
          <th>檢查點4</th>
          <th>檢查點5</th>
          <th>檢查點6</th>
          <th>檢查點7</th>
          <th>檢查點8</th>
          <th>檢查點9</th>
          <th>檢查點10</th>
          <th>檢查點11</th>
          <th>檢查點12</th>
          <th>檢查點13</th>
        </tr>
      </table>
    </div>
    <style>
      #listBox {
        padding: 5px;
        overflow: auto;
        width: 100%;
      }
      #list {
        margin: 0 auto;
      }
      #list th,
      #list td {
        padding: 3px;
        border: 1px solid #aaa;
      }
      #list th {
        background: rgba(100, 100, 100, 0.6);
      }
      #list td:nth-child(odd) {
        background: rgba(100, 100, 100, 0.4);
      }
      #list tr:hover {
        background: rgba(100, 100, 100, 0.8);
      }
    </style>

    <script>
      const socket = io("https://socketio.weishianglian.com", {
        transports: ["websocket"]
      });
      socket.on("connect", () => {
        console.log("socket connect!");

        socket.emit("yaoAdmin", { name: "yao" }, function(data) {
          data.map(d => createTr(d));
        });
        socket.on("yaoNew", function(data) {
          createTr(data);
        });
      });

      function createTr(data) {
        const { rawData } = data;
        const row = `
        <tr>
          <td>${rawData.class}</td>
          <td>${rawData.number}</td>
          <td>${rawData.team}</td>
          <td>${rawData.teamNumber}</td>
          <td>${rawData.checkPoint1}</td>
          <td>${rawData.checkPoint2}</td>
          <td>${rawData.checkPoint3}</td>
          <td>${rawData.checkPoint4}</td>
          <td>${rawData.checkPoint5}</td>
          <td>${rawData.checkPoint6}</td>
          <td>${rawData.checkPoint7}</td>
          <td>${rawData.checkPoint8}</td>
          <td>${rawData.checkPoint9}</td>
          <td>${rawData.checkPoint10}</td>
          <td>${rawData.checkPoint11}</td>
          <td>${rawData.checkPoint12}</td>
          <td>${rawData.checkPoint13}</td>
        </tr>`;
        $("#list").append(row);
      }
    </script>
  </body>
</html>
